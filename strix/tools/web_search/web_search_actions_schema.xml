<tools>
  <tool name="web_search">
    <description>Search the web for security information using multiple providers with automatic fallback.

IMPORTANT: This tool supports multiple search providers:
1. Perplexity AI (best - requires PERPLEXITY_API_KEY)
2. Tavily AI (good - requires TAVILY_API_KEY)
3. SerpAPI (Google - requires SERPAPI_API_KEY)
4. Google Custom Search (requires GOOGLE_CSE_API_KEY + GOOGLE_CSE_ID)
5. Brave Search (requires BRAVE_API_KEY)
6. DuckDuckGo (FREE - always available, no API key needed!)

The tool automatically selects the best available provider based on configured API keys.
If all premium providers fail, it falls back to DuckDuckGo.

Use this tool extensively for:
- Current vulnerabilities, CVEs, and security advisories
- Latest attack techniques, exploits, and proof-of-concepts
- Technology-specific security research and documentation
- Target reconnaissance and OSINT gathering
- Security tool documentation and usage guides
- Incident response and threat intelligence
- Compliance frameworks and security standards
- Bug bounty reports and security research findings
- Security conference talks and research papers</description>
    <details>This tool supports multiple search providers with automatic selection and fallback. DuckDuckGo is always available as a free option even without API keys. Premium providers like Perplexity AI offer better results for security research.</details>
    <parameters>
      <parameter name="query" type="string" required="true">
        <description>The search query or question you want to research. Be specific and include relevant technical terms, version numbers, or context for better results. Make it as detailed as possible, with the context of the current security assessment.</description>
      </parameter>
      <parameter name="provider" type="string" required="false">
        <description>Optional: Specific search provider to use. Options: perplexity, tavily, serpapi, google_cse, brave, duckduckgo. If not specified, automatically selects the best available provider.</description>
      </parameter>
    </parameters>
    <returns type="Dict[str, Any]">
      <description>Response containing:
- success: Whether the search was successful
- provider: Which search provider was used
- query: The original search query
- content: Search results or AI-generated response
- results: List of search results (when applicable)
- available_providers: List of all available providers
- message: Status message</description>
    </returns>
    <examples>
  # Basic search (auto-select best provider)
  <function=web_search>
  <parameter=query>OpenSSH 7.4 CVE exploits and privilege escalation techniques</parameter>
  </function>

  # Use specific provider
  <function=web_search>
  <parameter=query>WordPress 5.8.3 RCE exploits 2024</parameter>
  <parameter=provider>perplexity</parameter>
  </function>

  # Free search with DuckDuckGo
  <function=web_search>
  <parameter=query>Cloudflare WAF bypass techniques SQLi</parameter>
  <parameter=provider>duckduckgo</parameter>
  </function>

  # OSINT research
  <function=web_search>
  <parameter=query>target company "AcmeCorp" data breaches security incidents</parameter>
  </function>

  # Tool research
  <function=web_search>
  <parameter=query>best Python JWT security testing library 2024 pip</parameter>
  </function>
    </examples>
  </tool>

  <tool name="list_search_providers">
    <description>List all available web search providers and their configuration status.

Use this to see which search providers are available based on your configured API keys,
and get recommendations for the best provider to use.</description>
    <details>Returns detailed information about each search provider including whether it's available, what API key it needs, quality rating, and cost.</details>
    <parameters>
    </parameters>
    <returns type="Dict[str, Any]">
      <description>Response containing:
- available: List of configured and usable providers
- unavailable: List of providers that need API keys
- recommended: Best provider to use based on availability
- total_available: Number of available providers
- total_unavailable: Number of unavailable providers</description>
    </returns>
    <examples>
  # Check available search providers
  <function=list_search_providers>
  </function>
    </examples>
  </tool>
</tools>
